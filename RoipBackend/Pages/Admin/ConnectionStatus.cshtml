
@page
@model RoipBackend.Pages.Admin.ConnectionStatusModel
@{
    ViewData["Title"] = "Connection Status";
}

<h1>Active Connections</h1>
<div id="connections"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
<script>
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/userConnectionHub")
        .build();

    connection.on("UpdateConnections", function (connections) {
        const connectionsDiv = document.getElementById("connections");
        connectionsDiv.innerHTML = "";
        connections.forEach(conn => {
            const div = document.createElement("div");
            const email = conn.Email || "Unknown";
            const connectedAt = conn.ConnectedAt || "Unknown";
            div.textContent = `User Email: ${email}, Connected At: ${connectedAt}`;
            div.classList.add("connection-item"); // Add a CSS class for styling
            connectionsDiv.appendChild(div);
        });
    });

    connection.start().catch(err => console.error(err));
</script>
